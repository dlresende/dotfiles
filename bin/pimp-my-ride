#!/usr/bin/env bash

main() {
  install_homebrew
  install_stuff
  configure_vim
  configure_tmux
}

install_homebrew() {
  /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
}

install_stuff() {
  brew bundle
}

configure_vim() {
  if [[ ! -d "${HOME}/.vim" ]] ; then
    git clone https://github.com/luan/vimfiles.git ~/.vim
  fi
  (
  cd "${HOME}/.vim"
  git checkout master
  git pull -r
  ./update
  )
}

configure_tmux() {
  TMUX_PLUGIN_MANAGER_PATH="$HOME/.tmux/plugins"

  echo "Updating tmux plugins..."
  if [[ ! -d "$TMUX_PLUGIN_MANAGER_PATH/tpm" ]] ; then
    mkdir -p "$TMUX_PLUGIN_MANAGER_PATH"
    git clone https://github.com/tmux-plugins/tpm "$TMUX_PLUGIN_MANAGER_PATH/tpm"
    . $TMUX_PLUGIN_MANAGER_PATH/tpm/bin/install_plugins
  else
    (cd "$TMUX_PLUGIN_MANAGER_PATH/tpm" ; git pull )
    . $TMUX_PLUGIN_MANAGER_PATH/tpm/bin/update_plugins all
  fi
}

main
